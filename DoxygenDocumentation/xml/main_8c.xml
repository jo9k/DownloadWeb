<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.11">
  <compounddef id="main_8c" kind="file" language="C++">
    <compoundname>main.c</compoundname>
    <includes local="no">sys/select.h</includes>
    <includes local="no">time.h</includes>
    <includes local="no">unistd.h</includes>
    <includes local="no">sys/types.h</includes>
    <includes local="no">stdio.h</includes>
    <includes local="no">string.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes local="no">sys/socket.h</includes>
    <includes local="no">netdb.h</includes>
    <includes local="no">arpa/inet.h</includes>
    <includes local="no">sys/stat.h</includes>
    <incdepgraph>
      <node id="11">
        <label>sys/stat.h</label>
      </node>
      <node id="1">
        <label>sys/select.h</label>
      </node>
      <node id="10">
        <label>arpa/inet.h</label>
      </node>
      <node id="7">
        <label>stdlib.h</label>
      </node>
      <node id="0">
        <label>main.c</label>
        <link refid="main.c"/>
        <childnode refid="1" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>netdb.h</label>
      </node>
      <node id="4">
        <label>sys/types.h</label>
      </node>
      <node id="6">
        <label>string.h</label>
      </node>
      <node id="3">
        <label>unistd.h</label>
      </node>
      <node id="2">
        <label>time.h</label>
      </node>
      <node id="8">
        <label>sys/socket.h</label>
      </node>
      <node id="5">
        <label>stdio.h</label>
      </node>
    </incdepgraph>
    <innerclass refid="structwebaddr" prot="public">webaddr</innerclass>
    <innerclass refid="structsimple__list" prot="public">simple_list</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="main_8c_1a614217d263be1fb1a5f76e2ff7be19a2" prot="public" static="no">
        <name>PORT</name>
        <initializer>80</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>The port on which to listen for incoming data </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="41" column="9" bodyfile="main.c" bodystart="41" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="main_8c_1a946f3406a107a82227c4f33ea8598290" prot="public" static="no">
        <name>SOCKINQUEUE</name>
        <initializer>5</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Max number of socks in queue </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="42" column="9" bodyfile="main.c" bodystart="42" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="main_8c_1a4cb4212918ebefaca678d654dce4425e" prot="public" static="no">
        <name>URLSIZE</name>
        <initializer>256</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Max length of URL </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="43" column="9" bodyfile="main.c" bodystart="43" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="main_8c_1a47893e86457950c30831b9cb0e7c3235" prot="public" static="no">
        <name>HOSTSIZE</name>
        <initializer>50</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>For finding method of query </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="44" column="9" bodyfile="main.c" bodystart="44" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="main_8c_1ad974fe981249f5e84fbf1683b012c9f8" prot="public" static="no">
        <name>BUFLEN</name>
        <initializer>63000</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Max length of buffer -&gt; experimentally 128K, seems legitimate, after some checking ; For google we gonna need ~twice as much 131072 </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="45" column="9" bodyfile="main.c" bodystart="45" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="main_8c_1ac00bfb46347d26fdc58568fe1ab5fa5b" prot="public" static="no">
        <name>STDIN</name>
        <initializer>0</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Standard input </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="46" column="9" bodyfile="main.c" bodystart="46" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="main_8c_1a0cde4104edca15f3c3c51238bc0edbd1" prot="public" static="no">
        <name>TIMESIZE</name>
        <initializer>20</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Length of timestamp </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="47" column="9" bodyfile="main.c" bodystart="47" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="main_8c_1a50267d552ca6f788254032e40046b770" prot="public" static="no">
        <name>DEPTH</name>
        <initializer>2</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Maximum recurency depth </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="48" column="9" bodyfile="main.c" bodystart="48" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="main_8c_1a60d6a5ff7d7c74135c525acb9e8ee7a1" prot="public" static="no">
        <name>MAX_REQ</name>
        <initializer>50</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Maximum number of requests from one page </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="49" column="9" bodyfile="main.c" bodystart="49" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="typedef">
      <memberdef kind="typedef" id="main_8c_1a88984f2abd0c5475e5459be090288751" prot="public" static="no">
        <type>struct <ref refid="structwebaddr" kindref="compound">webaddr</ref></type>
        <definition>typedef struct webaddr  WebAddr</definition>
        <argsstring></argsstring>
        <name>WebAddr</name>
        <briefdescription>
<para>Struct for Webadresses. </para>        </briefdescription>
        <detaileddescription>
<para>Saves the text representation of the URL, the hostname and the link within the webpage. Also the text representation of the IP can be saved </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="59" column="1"/>
      </memberdef>
      <memberdef kind="typedef" id="main_8c_1a9ab63ef09aeb9a540049d985a347d02b" prot="public" static="no">
        <type>struct <ref refid="structsimple__list" kindref="compound">simple_list</ref></type>
        <definition>typedef struct simple_list  list</definition>
        <argsstring></argsstring>
        <name>list</name>
        <briefdescription>
<para>Struct for list. </para>        </briefdescription>
        <detaileddescription>
<para>Used to list character strings of new requests </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="66" column="1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="main_8c_1a8b87b233658bd1635573fa82a38441e9" prot="public" static="no" mutable="no">
        <type>struct sockaddr_in</type>
        <definition>struct sockaddr_in si_server</definition>
        <argsstring></argsstring>
        <name>si_server</name>
        <initializer>{
	char timebuff[<ref refid="main_8c_1a0cde4104edca15f3c3c51238bc0edbd1" kindref="member">TIMESIZE</ref>]</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="410" column="1" bodyfile="main.c" bodystart="413" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a63365583bb04acd30e30fc3239879356" prot="public" static="no" mutable="no">
        <type>socklen_t</type>
        <definition>socklen_t sock_length</definition>
        <argsstring></argsstring>
        <name>sock_length</name>
        <initializer>= sizeof(<ref refid="main_8c_1a8b87b233658bd1635573fa82a38441e9" kindref="member">si_server</ref>)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="414" column="1" bodyfile="main.c" bodystart="414" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a5faf35ef04c3a66a39ae4301d53a8851" prot="public" static="no" mutable="no">
        <type>char</type>
        <definition>char data[BUFLEN]</definition>
        <argsstring>[BUFLEN]</argsstring>
        <name>data</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="415" column="1" bodyfile="main.c" bodystart="415" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a7ee9c2c6090084f2f66e2e6fa03ee581" prot="public" static="no" mutable="no">
        <type>int</type>
        <definition>sock_id</definition>
        <argsstring></argsstring>
        <name>sock_id</name>
        <initializer>= socket(AF_INET, SOCK_STREAM, 0)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="416" column="1" bodyfile="main.c" bodystart="416" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a951f9b990c2279828c39a5da644c630e" prot="public" static="no" mutable="no">
        <type>int</type>
        <definition>int rcv_length</definition>
        <argsstring></argsstring>
        <name>rcv_length</name>
        <initializer>=-1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="417" column="1" bodyfile="main.c" bodystart="417" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a7c20c420237aa9283515ea5c242479e7" prot="public" static="no" mutable="no">
        <type>*</type>
        <definition>* buflen</definition>
        <argsstring></argsstring>
        <name>buflen</name>
        <initializer>= 0</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="418" column="1" bodyfile="main.c" bodystart="418" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a51e6a0d2bcb8531a5e5adcd66a77aa3b" prot="public" static="no" mutable="no">
        <type>char *</type>
        <definition>request</definition>
        <argsstring></argsstring>
        <name>request</name>
        <initializer>= (char*) malloc (sizeof(website-&gt;hostname)*strlen(website-&gt;hostname)+sizeof(website-&gt;page)*strlen(website-&gt;page)+sizeof(char)*75)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="420" column="1" bodyfile="main.c" bodystart="420" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a7198490587a04eeee9283e64a36774c3" prot="public" static="no" mutable="no">
        <type><ref refid="main_8c_1a8b87b233658bd1635573fa82a38441e9" kindref="member">si_server</ref></type>
        <definition>si_server sin_family</definition>
        <argsstring></argsstring>
        <name>sin_family</name>
        <initializer>= AF_INET</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="433" column="1" bodyfile="main.c" bodystart="433" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a4e4f9f1a0626b75aac07a9efc4e1aee4" prot="public" static="no" mutable="no">
        <type><ref refid="main_8c_1a8b87b233658bd1635573fa82a38441e9" kindref="member">si_server</ref></type>
        <definition>si_server sin_port</definition>
        <argsstring></argsstring>
        <name>sin_port</name>
        <initializer>= htons(<ref refid="main_8c_1a614217d263be1fb1a5f76e2ff7be19a2" kindref="member">PORT</ref>)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="434" column="1" bodyfile="main.c" bodystart="434" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a0544c3fe466e421738dae463968b70ba" prot="public" static="no" mutable="no">
        <type></type>
        <definition>else</definition>
        <argsstring></argsstring>
        <name>else</name>
        <initializer>{
		<ref refid="main_8c_1a5b8d4cf7b8c6b22aa88794fb71fa852f" kindref="member">fprintf</ref>(logfile, &quot;%s %s\n&quot;, getTimeBuffer(timebuff), &quot;send() inside <ref refid="main_8c_1a3310125badd0ce971c1098c13655edcb" kindref="member">requestWebsite</ref>() :: SUCCESS&quot;)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="461" column="1" bodyfile="main.c" bodystart="462" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1ae447355422889376eec4096495140356" prot="public" static="no" mutable="no">
        <type>char *</type>
        <definition>char* beginning_of_data</definition>
        <argsstring></argsstring>
        <name>beginning_of_data</name>
        <initializer>=strstr(buffer,&quot;\r\n\r\n&quot;)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="499" column="1" bodyfile="main.c" bodystart="499" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1aed7ea92f45bd273dde380a45ddced592" prot="public" static="no" mutable="no">
        <type>int</type>
        <definition>int offset</definition>
        <argsstring></argsstring>
        <name>offset</name>
        <initializer>= <ref refid="main_8c_1ae447355422889376eec4096495140356" kindref="member">beginning_of_data</ref>-buffer+4</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="500" column="1" bodyfile="main.c" bodystart="500" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a1a8bb385160d2854b0c2ebb85db2d212" prot="public" static="no" mutable="no">
        <type>return</type>
        <definition>return EXIT_SUCCESS</definition>
        <argsstring></argsstring>
        <name>EXIT_SUCCESS</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="509" column="1" bodyfile="main.c" bodystart="509" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1aa1255e60c8817037d368185e7890b1c5" prot="public" static="no" mutable="no">
        <type><ref refid="main_8c_1a08fed31ac160af672213774bd2392159" kindref="member">new_requests</ref></type>
        <definition>new_requests string</definition>
        <argsstring></argsstring>
        <name>string</name>
        <initializer>= (char*) malloc(<ref refid="main_8c_1a4cb4212918ebefaca678d654dce4425e" kindref="member">URLSIZE</ref>)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="524" column="1" bodyfile="main.c" bodystart="524" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a34bcf9f163ce26968812dff83ee92226" prot="public" static="no" mutable="no">
        <type><ref refid="main_8c_1a9ab63ef09aeb9a540049d985a347d02b" kindref="member">list</ref> *</type>
        <definition>list* initial_pointer</definition>
        <argsstring></argsstring>
        <name>initial_pointer</name>
        <initializer>= <ref refid="main_8c_1a08fed31ac160af672213774bd2392159" kindref="member">new_requests</ref></initializer>
        <briefdescription>
<para>buffer beginning of list </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="526" column="1" bodyfile="main.c" bodystart="526" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a70558265885283cfdbfb00c08d22c5b5" prot="public" static="no" mutable="no">
        <type>char *</type>
        <definition>pch</definition>
        <argsstring></argsstring>
        <name>pch</name>
        <initializer>=content</initializer>
        <briefdescription>
<para>reset position of search pointer </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="527" column="1" bodyfile="main.c" bodystart="527" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a0b3c00e3771bedff51dc5e6999709bcf" prot="public" static="no" mutable="no">
        <type>char *</type>
        <definition>char * positionbuf</definition>
        <argsstring></argsstring>
        <name>positionbuf</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="527" column="1" bodyfile="main.c" bodystart="527" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a06a82fbaf784823f4d43dde28f35afc1" prot="public" static="no" mutable="no">
        <type>char *</type>
        <definition>char* tmp</definition>
        <argsstring></argsstring>
        <name>tmp</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="528" column="1" bodyfile="main.c" bodystart="528" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1acb559820d9ca11295b4500f179ef6392" prot="public" static="no" mutable="no">
        <type>int</type>
        <definition>int i</definition>
        <argsstring></argsstring>
        <name>i</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="529" column="1" bodyfile="main.c" bodystart="529" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="main_8c_1a08fed31ac160af672213774bd2392159" prot="public" static="no" mutable="no">
        <type></type>
        <definition>new_requests</definition>
        <argsstring></argsstring>
        <name>new_requests</name>
        <initializer>= <ref refid="main_8c_1a34bcf9f163ce26968812dff83ee92226" kindref="member">initial_pointer</ref></initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="580" column="1" bodyfile="main.c" bodystart="580" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="main_8c_1ad2e9329c79af041e6af1066c4aea42d7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void die</definition>
        <argsstring>(char *s, int i)</argsstring>
        <name>die</name>
        <param>
          <type>char *</type>
          <declname>s</declname>
          <briefdescription><para>error message </para></briefdescription>
        </param>
        <param>
          <type>int</type>
          <declname>i</declname>
          <briefdescription><para>error number </para></briefdescription>
        </param>
        <briefdescription>
<para>Custom error function. </para>        </briefdescription>
        <detaileddescription>
<para>Outputs the error string s and exits program with exit number i <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>s</parametername>
</parameternamelist>
<parameterdescription>
<para>char string with error Message </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>i</parametername>
</parameternamelist>
<parameterdescription>
<para>error number </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="68" column="1" bodyfile="main.c" bodystart="224" bodyend="228"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a0927899c9935565cac8bab05b2fe2342" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int processSite</definition>
        <argsstring>(char *name, FILE *log, int depth, char *current_folder)</argsstring>
        <name>processSite</name>
        <param>
          <type>char *</type>
          <declname>name</declname>
          <briefdescription><para>name of the webpage </para></briefdescription>
        </param>
        <param>
          <type>FILE *</type>
          <declname>log</declname>
          <briefdescription><para>pointer to logfile </para></briefdescription>
        </param>
        <param>
          <type>int</type>
          <declname>depth</declname>
          <briefdescription><para>recursion depth </para></briefdescription>
        </param>
        <param>
          <type>char *</type>
          <declname>current_folder</declname>
          <briefdescription><para>folder to write-in </para></briefdescription>
        </param>
        <briefdescription>
<para>Download contents of webpage recursively and start the logging process. </para>        </briefdescription>
        <detaileddescription>
<para>A textfile under the name name is created for logging, a WebAddr struct is initialized and the webpage contents are downloaded recursively <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>log</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to logfile </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>depth</parametername>
</parameternamelist>
<parameterdescription>
<para>depth of the recursion </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>current_folder</parametername>
</parameternamelist>
<parameterdescription>
<para>is pointer to char string containing directory for file save </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success 1 on failure </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
<para>processing website address</para><para>download the website</para><para>extract all the links from the website and change to relative addressing</para><para>create folders for all the websites and write content (ie the downloaded file from website) to folder</para><para>if it&apos;s html site, then create it another folder, else leave dir unchanged</para><para>if main site, ie. no file name for saving</para><para>filename cannot consist of &quot;/&quot; so <ulink url="http://">http://</ulink> ommited</para><para>try to open file for saving data</para><para>save the file</para><para>recursively call <ref refid="main_8c_1a0927899c9935565cac8bab05b2fe2342" kindref="member">processSite()</ref> for all the found links src = full addresses or relative ones </para>        </inbodydescription>
        <location file="main.c" line="69" column="1" bodyfile="main.c" bodystart="596" bodyend="693"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a08fdc4145d944803c9113e813daabfd7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int processQuery</definition>
        <argsstring>(char *query, FILE *log)</argsstring>
        <name>processQuery</name>
        <param>
          <type>char *</type>
          <declname>query</declname>
          <briefdescription><para>string containing the query in html format </para></briefdescription>
        </param>
        <param>
          <type>FILE *</type>
          <declname>log</declname>
          <briefdescription><para>pointer to logfile </para></briefdescription>
        </param>
        <briefdescription>
<para>Uses google.de to search for the given string. </para>        </briefdescription>
        <detaileddescription>
<para>The given string is the argument of a google search on the german google servers. The resulting webpage is downloaded. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>query</parametername>
</parameternamelist>
<parameterdescription>
<para>input string for the google Query </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>log</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to logfile </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
<para>logging system if no global log file exists.</para><para>if directory doesn&apos;t exist, create directory</para><para>processing query </para>        </inbodydescription>
        <location file="main.c" line="70" column="1" bodyfile="main.c" bodystart="335" bodyend="396"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a60fab1f99c8e95160f038def2f54015d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>char *</type>
        <definition>char * getTimeBuffer</definition>
        <argsstring>(char *timebuff)</argsstring>
        <name>getTimeBuffer</name>
        <param>
          <type>char *</type>
          <declname>timebuff</declname>
          <briefdescription><para>pointer to char string with timestamp </para></briefdescription>
        </param>
        <briefdescription>
<para>Reads the time base, creates a timestamp and writes the result into char string timebuff. </para>        </briefdescription>
        <detaileddescription>
<para>Timestamp in Format YMD HMS <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>timebuf</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to string to write timestamp to </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>pointer to string which contains the timestamp </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="71" column="1" bodyfile="main.c" bodystart="235" bodyend="242"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a3ec9442703dfaaa0430bb5cbdadfcbf4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int preprocess_website</definition>
        <argsstring>(WebAddr *website, FILE *log)</argsstring>
        <name>preprocess_website</name>
        <param>
          <type><ref refid="main_8c_1a88984f2abd0c5475e5459be090288751" kindref="member">WebAddr</ref> *</type>
          <declname>website</declname>
          <briefdescription><para>pointer to WebAddr struct </para></briefdescription>
        </param>
        <param>
          <type>FILE *</type>
          <declname>log</declname>
          <briefdescription><para>pointer to logfile </para></briefdescription>
        </param>
        <briefdescription>
<para>Converts the hostname to a IP address, prepares webpage address for processing in the program. </para>        </briefdescription>
        <detaileddescription>
<para>Extracts the hostname and the relative address on the server from the given URL, query the DNS to obtain the IP addresses linked to that webpage and save the result in a WebAddr struct, <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>website</parametername>
</parameternamelist>
<parameterdescription>
<para>WebAddr pointer which provides website address, the IP address will be added </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>log</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to logfile </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success and 1 on error </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
<para>check argument *website</para><para>check buffer overflow</para><para>start processing, search for the first / after the web address, this position tells where the hostname ends and where the relative page address starts</para><para>strings not zero terminated!</para><para>get the IP address for the website</para><para>loop through all the results and connect to the first we can </para>        </inbodydescription>
        <location file="main.c" line="72" column="1" bodyfile="main.c" bodystart="254" bodyend="324"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a3310125badd0ce971c1098c13655edcb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int requestWebsite</definition>
        <argsstring>(WebAddr *website, FILE *log, char *buffer,unsigned int *buflen)</argsstring>
        <name>requestWebsite</name>
        <param>
          <type><ref refid="main_8c_1a88984f2abd0c5475e5459be090288751" kindref="member">WebAddr</ref> *</type>
          <declname>website</declname>
          <briefdescription><para>pointer to WebAddr struct </para></briefdescription>
        </param>
        <param>
          <type>FILE *</type>
          <declname>log</declname>
          <briefdescription><para>pointer to logfile </para></briefdescription>
        </param>
        <param>
          <type>char *</type>
          <declname>buffer</declname>
          <briefdescription><para>pointer to received content </para></briefdescription>
        </param>
        <param>
          <type>unsigned int *</type>
          <declname>buflen</declname>
          <briefdescription><para>pointer to received data size </para></briefdescription>
        </param>
        <briefdescription>
<para>Download the webpage. </para>        </briefdescription>
        <detaileddescription>
<para>Assemble the http command for downloading the webpage given in WebAddr struct. Send the request to the server and download the webpage <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>website</parametername>
</parameternamelist>
<parameterdescription>
<para>website to be downloaded </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>log</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to logfile </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>buffer</parametername>
</parameternamelist>
<parameterdescription>
<para>char string for the website DATA </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>buflen</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to unsigned int returns size of received data </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success 1 on failure </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="73" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1ae2a4d2cd293581a9bf485ce2a5b80abb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int editAndSave</definition>
        <argsstring>(WebAddr *website, FILE *log, char *content, list *new_requests)</argsstring>
        <name>editAndSave</name>
        <param>
          <type><ref refid="main_8c_1a88984f2abd0c5475e5459be090288751" kindref="member">WebAddr</ref> *</type>
          <declname>website</declname>
          <briefdescription><para>pointer to WebAddr struct </para></briefdescription>
        </param>
        <param>
          <type>FILE *</type>
          <declname>log</declname>
          <briefdescription><para>pointer to logfile </para></briefdescription>
        </param>
        <param>
          <type>char *</type>
          <declname>content</declname>
          <briefdescription><para>pointer to formatted data </para></briefdescription>
        </param>
        <param>
          <type><ref refid="main_8c_1a9ab63ef09aeb9a540049d985a347d02b" kindref="member">list</ref> *</type>
          <declname>new_requests</declname>
          <briefdescription><para>pointer to list of new http queries </para></briefdescription>
        </param>
        <briefdescription>
<para>Edits contents of webpage and tries to retrieve links to other sites/resources to be downloaded. </para>        </briefdescription>
        <detaileddescription>
<para>List with new requests is filled with request found on the site. max number of requests is MAX_REQ <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>website</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to WebAddr struct </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>log</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to logfile </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>content</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to data to edit </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>*new_requests</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to list of new requests for further iterations </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success 1 on failure </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="74" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1ae66f6b31b5ad750f1fe042a706a4e3d4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int main</definition>
        <argsstring>()</argsstring>
        <name>main</name>
        <briefdescription>
<para>Main function. </para>        </briefdescription>
        <detaileddescription>
<para>Calls the functions necessary for the function of the program, also all the steps for logging are implemented here. Select is used to efficiently wait for user input </para>        </detaileddescription>
        <inbodydescription>
<para>&lt; master fd_set for restoring the flag status</para><para>&lt; temp fd_set for checking the flag status by select()</para><para>preparing pointers and variables for logging</para><para>&lt; File pointer</para><para>generate a filename</para><para>concatenate path&amp;filename</para><para>restore temp_set</para><para>register stdin for select</para><para>Any number of file descriptors is ready to be read</para><para>Read data from stdin using fgets.</para><para>Remove trailing newline character from the input buffer if needed.</para><para>Starting application shutdown procedure</para><para>Processing URL query</para><para>Processing google query</para><para>Writes help manual in console </para>        </inbodydescription>
        <location file="main.c" line="79" column="1" bodyfile="main.c" bodystart="79" bodyend="217"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a9c637955d59085590770de85709bd193" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fprintf</definition>
        <argsstring>(logfile,&quot;%s %s\n&quot;, getTimeBuffer(timebuff),&quot;Initialisation of requestWebsite() inside of processSite()&quot;)</argsstring>
        <name>fprintf</name>
        <param>
          <type>logfile</type>
        </param>
        <param>
          <type>&quot;%s %s\n&quot;</type>
        </param>
        <param>
          <type><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff)</type>
        </param>
        <param>
          <type>&quot;Initialisation of <ref refid="main_8c_1a3310125badd0ce971c1098c13655edcb" kindref="member">requestWebsite</ref>() inside of <ref refid="main_8c_1a0927899c9935565cac8bab05b2fe2342" kindref="member">processSite</ref>()&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="419" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>strcpy</definition>
        <argsstring>(request,&quot;GET &quot;)</argsstring>
        <name>strcpy</name>
        <param>
          <type><ref refid="main_8c_1a51e6a0d2bcb8531a5e5adcd66a77aa3b" kindref="member">request</ref></type>
        </param>
        <param>
          <type>&quot;GET &quot;</type>
        </param>
        <briefdescription>
<para>HTTP REQUEST. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="423" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>strcat</definition>
        <argsstring>(request, website-&gt;page)</argsstring>
        <name>strcat</name>
        <param>
          <type><ref refid="main_8c_1a51e6a0d2bcb8531a5e5adcd66a77aa3b" kindref="member">request</ref></type>
        </param>
        <param>
          <type>website-&gt;</type>
          <declname>page</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="424" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1af513ef54a4565744712f1893dfe87ffd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>strcat</definition>
        <argsstring>(request,&quot; HTTP/1.1\r\nHost: &quot;)</argsstring>
        <name>strcat</name>
        <param>
          <type><ref refid="main_8c_1a51e6a0d2bcb8531a5e5adcd66a77aa3b" kindref="member">request</ref></type>
        </param>
        <param>
          <type>&quot; HTTP/1.1\r\nHost: &quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="426" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1ab1e4f7e6f56c8019c581b9f22904379b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>strcat</definition>
        <argsstring>(request, website-&gt;hostname+7)</argsstring>
        <name>strcat</name>
        <param>
          <type><ref refid="main_8c_1a51e6a0d2bcb8531a5e5adcd66a77aa3b" kindref="member">request</ref></type>
        </param>
        <param>
          <type>website-&gt;hostname+</type>
          <declname>7</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="427" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1afd8866b7bd4aab3f72e14fb814271033" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>strcat</definition>
        <argsstring>(request,&quot;\r\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:44.0) Gecko/20100101 Firefox/44.0\r\n&quot;)</argsstring>
        <name>strcat</name>
        <param>
          <type><ref refid="main_8c_1a51e6a0d2bcb8531a5e5adcd66a77aa3b" kindref="member">request</ref></type>
        </param>
        <param>
          <type>&quot;\r\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:44.0) Gecko/20100101 Firefox/44.0\r\n&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="428" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1adc7b3e21dcb3f1f79190a210087cd3a3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>strcat</definition>
        <argsstring>(request,&quot;\r\n&quot;)</argsstring>
        <name>strcat</name>
        <param>
          <type><ref refid="main_8c_1a51e6a0d2bcb8531a5e5adcd66a77aa3b" kindref="member">request</ref></type>
        </param>
        <param>
          <type>&quot;\r\n&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="429" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a89b9a9f0f6b5c6de49a3b86f601003a8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fprintf</definition>
        <argsstring>(logfile,&quot;%s\n%s\n%s\n&quot;, getTimeBuffer(timebuff),&quot;SENT REQUEST:&quot;, request)</argsstring>
        <name>fprintf</name>
        <param>
          <type>logfile</type>
        </param>
        <param>
          <type>&quot;%s\n%s\n%s\n&quot;</type>
        </param>
        <param>
          <type><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff)</type>
        </param>
        <param>
          <type>&quot;SENT REQUEST:&quot;</type>
        </param>
        <param>
          <type><ref refid="main_8c_1a51e6a0d2bcb8531a5e5adcd66a77aa3b" kindref="member">request</ref></type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="430" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a5e983cb99d0067297dc556d97f99ade0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>memset</definition>
        <argsstring>((char *)&amp;si_server, 0, sizeof(si_server))</argsstring>
        <name>memset</name>
        <param>
          <type>(char *)&amp;</type>
          <declname>si_server</declname>
        </param>
        <param>
          <type>0</type>
        </param>
        <param>
          <type>sizeof(<ref refid="main_8c_1a8b87b233658bd1635573fa82a38441e9" kindref="member">si_server</ref>)</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="432" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1ad9e9334bfa34578f7ec7593336511718" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>if</definition>
        <argsstring>(if(connect(sock_id==-1)</argsstring>
        <name>if</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="437" column="1" bodyfile="main.c" bodystart="437" bodyend="455"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a5c5e05e668ec72135dfc6db38b4a6f31" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>if</definition>
        <argsstring>(send(sock_id, request, strlen(request), 0)&lt; 0)</argsstring>
        <name>if</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="456" column="1" bodyfile="main.c" bodystart="456" bodyend="460"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a8fdafe3be7e00ce3d4f0cb50a9a5eb39" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>while</definition>
        <argsstring>(1)</argsstring>
        <name>while</name>
        <param>
          <type>1</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="466" column="1" bodyfile="main.c" bodystart="466" bodyend="498"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a47b73605297e2c3a54d5d3ffd8881be0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>if</definition>
        <argsstring>(beginning_of_data!=NULL)</argsstring>
        <name>if</name>
        <param>
          <type>beginning_of_data!</type>
          <defval>NULL</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="501" column="1" bodyfile="main.c" bodystart="501" bodyend="507"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a2f6ecf16430ef9fee42b41d25af1bfc7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>close</definition>
        <argsstring>(sock_id)</argsstring>
        <name>close</name>
        <param>
          <type><ref refid="main_8c_1a7ee9c2c6090084f2f66e2e6fa03ee581" kindref="member">sock_id</ref></type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="508" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1ac1276344ad97932136505d7c7164f7ed" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fprintf</definition>
        <argsstring>(logfile,&quot;%s %s\n&quot;, getTimeBuffer(timebuff),&quot;Initialisation of editAndSave() inside of processSite()&quot;)</argsstring>
        <name>fprintf</name>
        <param>
          <type>logfile</type>
        </param>
        <param>
          <type>&quot;%s %s\n&quot;</type>
        </param>
        <param>
          <type><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff)</type>
        </param>
        <param>
          <type>&quot;Initialisation of <ref refid="main_8c_1ae2a4d2cd293581a9bf485ce2a5b80abb" kindref="member">editAndSave</ref>() inside of <ref refid="main_8c_1a0927899c9935565cac8bab05b2fe2342" kindref="member">processSite</ref>()&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="522" column="1"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1af91ba5c47d97d6a75c9fbc4f40a8e506" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>for</definition>
        <argsstring>(i=0;i&lt; MAX_REQ;)</argsstring>
        <name>for</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
<para>check if we have an absolute link, if so the path in the !saved! file has to be changed!</para><para>relative link =&gt; add website address but the path in the !saved! file can stay the same (Browser will look in the same folder for this files)</para><para>check if we have an absolute link, if so the path in the !saved! file has to be changed!</para><para>relative link =&gt; add website address but the path in the !saved! file can stay the same (Browser will look in the same folder for this files) </para>        </inbodydescription>
        <location file="main.c" line="530" column="1" bodyfile="main.c" bodystart="530" bodyend="553"/>
      </memberdef>
      <memberdef kind="function" id="main_8c_1a5b8d4cf7b8c6b22aa88794fb71fa852f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fprintf</definition>
        <argsstring>(logfile,&quot;%s %s\n&quot;, getTimeBuffer(timebuff),&quot;All links of the website have been saved&quot;)</argsstring>
        <name>fprintf</name>
        <param>
          <type>logfile</type>
        </param>
        <param>
          <type>&quot;%s %s\n&quot;</type>
        </param>
        <param>
          <type><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff)</type>
        </param>
        <param>
          <type>&quot;All links of the website have been saved&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="main.c" line="581" column="1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>main.c</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/><sp/>Created<sp/>on:<sp/>Jan<sp/>08,<sp/>2016</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>Author:<sp/>mode</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="comment">/*<sp/>According<sp/>to<sp/>POSIX.1-2001,<sp/>POSIX.1-2008<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sys/select.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>According<sp/>to<sp/>earlier<sp/>standards<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;time.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;unistd.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sys/types.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdlib.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;unistd.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sys/socket.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;netdb.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#include&lt;arpa/inet.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sys/types.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sys/stat.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;unistd.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>PORT<sp/>80<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="42"><highlight class="preprocessor">#define<sp/>SOCKINQUEUE<sp/>5<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="43"><highlight class="preprocessor">#define<sp/>URLSIZE<sp/>256<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="44"><highlight class="preprocessor">#define<sp/>HOSTSIZE<sp/>50<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="45"><highlight class="preprocessor">#define<sp/>BUFLEN<sp/>63000<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="46"><highlight class="preprocessor">#define<sp/>STDIN<sp/>0<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="47"><highlight class="preprocessor">#define<sp/>TIMESIZE<sp/>20<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="48"><highlight class="preprocessor">#define<sp/>DEPTH<sp/>2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="49"><highlight class="preprocessor">#define<sp/>MAX_REQ<sp/>50<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="51"><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="53" refid="structwebaddr" refkind="compound"><highlight class="preprocessor">typedef<sp/>struct<sp/>webaddr<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>hostname[<ref refid="main_8c_1a47893e86457950c30831b9cb0e7c3235" kindref="member">HOSTSIZE</ref>];</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>url[<ref refid="main_8c_1a4cb4212918ebefaca678d654dce4425e" kindref="member">URLSIZE</ref>];<sp/></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>IP[50];</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>page[<ref refid="main_8c_1a4cb4212918ebefaca678d654dce4425e" kindref="member">URLSIZE</ref>-<ref refid="main_8c_1a47893e86457950c30831b9cb0e7c3235" kindref="member">HOSTSIZE</ref>];</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>filename<sp/>[<ref refid="main_8c_1a4cb4212918ebefaca678d654dce4425e" kindref="member">URLSIZE</ref>-<ref refid="main_8c_1a47893e86457950c30831b9cb0e7c3235" kindref="member">HOSTSIZE</ref>];</highlight></codeline>
<codeline lineno="59"><highlight class="normal">}<sp/><ref refid="main_8c_1a88984f2abd0c5475e5459be090288751" kindref="member">WebAddr</ref>;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"></codeline>
<codeline lineno="63" refid="structsimple__list" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structsimple__list" kindref="compound">simple_list</ref>{</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structsimple__list" kindref="compound">simple_list</ref>*<sp/><ref refid="structsimple__list_1a136337c2e78395502680cfc27cb1dc0e" kindref="member">next</ref>;<sp/></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/><ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref>;<sp/></highlight></codeline>
<codeline lineno="66"><highlight class="normal">}<sp/><ref refid="main_8c_1a9ab63ef09aeb9a540049d985a347d02b" kindref="member">list</ref>;</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="main_8c_1ad2e9329c79af041e6af1066c4aea42d7" kindref="member">die</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*s<sp/>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1acb559820d9ca11295b4500f179ef6392" kindref="member">i</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//custom<sp/>error<sp/>function</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a0927899c9935565cac8bab05b2fe2342" kindref="member">processSite</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*name,<sp/>FILE<sp/>*log,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>depth,</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/>current_folder);</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a08fdc4145d944803c9113e813daabfd7" kindref="member">processQuery</ref><sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*query<sp/>,<sp/>FILE<sp/>*log<sp/>);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*timebuff<sp/>);</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a3ec9442703dfaaa0430bb5cbdadfcbf4" kindref="member">preprocess_website</ref>(<ref refid="structwebaddr" kindref="compound">WebAddr</ref><sp/>*website,<sp/>FILE<sp/>*log);</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a3310125badd0ce971c1098c13655edcb" kindref="member">requestWebsite</ref><sp/>(<ref refid="structwebaddr" kindref="compound">WebAddr</ref><sp/>*website<sp/>,<sp/>FILE<sp/>*log<sp/>,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*buffer<sp/>,</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*<ref refid="main_8c_1a7c20c420237aa9283515ea5c242479e7" kindref="member">buflen</ref><sp/><sp/>);</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1ae2a4d2cd293581a9bf485ce2a5b80abb" kindref="member">editAndSave</ref><sp/>(<ref refid="structwebaddr" kindref="compound">WebAddr</ref><sp/>*website<sp/>,<sp/>FILE<sp/>*log<sp/>,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*content<sp/>,<sp/><ref refid="structsimple__list" kindref="compound">list</ref><sp/>*<ref refid="main_8c_1a08fed31ac160af672213774bd2392159" kindref="member">new_requests</ref><sp/>);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"></codeline>
<codeline lineno="79"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1ae66f6b31b5ad750f1fe042a706a4e3d4" kindref="member">main</ref>()</highlight></codeline>
<codeline lineno="80"><highlight class="normal">{</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//master<sp/>set</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/>fd_set<sp/>master_set;<sp/></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ready;</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/>FD_ZERO(&amp;master_set);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/>FD_SET<sp/>(<ref refid="main_8c_1ac00bfb46347d26fdc58568fe1ab5fa5b" kindref="member">STDIN</ref>,<sp/>&amp;master_set);</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//tmp_set</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/>fd_set<sp/>tmp_set;<sp/></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>FD_ZERO(&amp;tmp_set);</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//two<sp/>more<sp/>variables<sp/>for<sp/>work<sp/>with<sp/>stdin</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>stdbuff[<ref refid="main_8c_1a4cb4212918ebefaca678d654dce4425e" kindref="member">URLSIZE</ref>]<sp/>=<sp/>{0};<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//We<sp/>don&apos;t<sp/>expect<sp/>user<sp/>to<sp/>enter<sp/>query<sp/>longer<sp/>than<sp/>expected<sp/>URL<sp/>sizes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lenbuf;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>FILE<sp/>*logfile;<sp/></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*logname;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*logdir;</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>timebuff[<ref refid="main_8c_1a0cde4104edca15f3c3c51238bc0edbd1" kindref="member">TIMESIZE</ref>];</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/>logname<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc<sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)*32);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(logname,</highlight><highlight class="stringliteral">&quot;SESSION<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(logname,<ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff));</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(logname,</highlight><highlight class="stringliteral">&quot;.txt&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>logdir<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc<sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(logname)*strlen(logname)+</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(char)*7);</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(logdir,<sp/></highlight><highlight class="stringliteral">&quot;./logs/&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>directory<sp/>doesn&apos;t<sp/>exist,<sp/>create<sp/>directory</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">stat<sp/>st<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat(logdir,<sp/>&amp;st)<sp/>==<sp/>-1)</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mkdir(logdir,<sp/>0700);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(logdir,logname);</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/>logfile=fopen(logdir,</highlight><highlight class="stringliteral">&quot;w&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(logfile==NULL)</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Unable<sp/>to<sp/>create<sp/>%s<sp/>file.\n&quot;</highlight><highlight class="normal">,<sp/>logname);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ad2e9329c79af041e6af1066c4aea42d7" kindref="member">die</ref>(</highlight><highlight class="stringliteral">&quot;error<sp/>creating<sp/>log<sp/>file&quot;</highlight><highlight class="normal">,<sp/>5);</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;New<sp/>session<sp/>started&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//choose<sp/>initial<sp/>folder<sp/>to<sp/>download<sp/>the<sp/>webiste<sp/>in</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/>websiteDir<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc<sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)*<ref refid="main_8c_1a4cb4212918ebefaca678d654dce4425e" kindref="member">URLSIZE</ref>);</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(websiteDir,</highlight><highlight class="stringliteral">&quot;./&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Welcome<sp/>in<sp/>DownloadWeb<sp/>application.\nType<sp/>\&quot;help.\&quot;<sp/>for<sp/>help<sp/>instructions\n\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(1)</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ready=0;</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fflush<sp/>(stdout);</highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp_set<sp/>=<sp/>master_set;</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ready=select(FD_SETSIZE,<sp/>&amp;tmp_set,<sp/>NULL,<sp/>NULL,<sp/>NULL);</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ready<sp/>==<sp/>-1)</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>while<sp/>selecting!&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ad2e9329c79af041e6af1066c4aea42d7" kindref="member">die</ref>(</highlight><highlight class="stringliteral">&quot;select()&quot;</highlight><highlight class="normal">,1);</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FD_ISSET(<ref refid="main_8c_1ac00bfb46347d26fdc58568fe1ab5fa5b" kindref="member">STDIN</ref>,<sp/>&amp;tmp_set)<sp/>&amp;&amp;<sp/>ready)</highlight><highlight class="comment">//<sp/>listen<sp/>has<sp/>read<sp/>access-&gt;<sp/>accept<sp/>new<sp/>connection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fgets(stdbuff,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(stdbuff),<sp/>stdin);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lenbuf<sp/>=<sp/>strlen(stdbuff)<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stdbuff[lenbuf]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stdbuff[lenbuf]<sp/>=<sp/></highlight><highlight class="charliteral">&apos;\0&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!strcmp(stdbuff,<sp/></highlight><highlight class="stringliteral">&quot;q.&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Terminating...\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;User<sp/>input:&quot;</highlight><highlight class="normal">,stdbuff);</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;System<sp/>response:&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;Close<sp/>application.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a1a8bb385160d2854b0c2ebb85db2d212" kindref="member">EXIT_SUCCESS</ref>;</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!strncmp<sp/>(stdbuff,</highlight><highlight class="stringliteral">&quot;http://&quot;</highlight><highlight class="normal">,7))</highlight><highlight class="comment">//processing<sp/>URL<sp/>query</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Starting<sp/>processing<sp/>given<sp/>website,<sp/>please<sp/>wait...\n%s\n&quot;</highlight><highlight class="normal">,<sp/>stdbuff);</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;User<sp/>input:&quot;</highlight><highlight class="normal">,stdbuff);</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;System<sp/>response:&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;WWW<sp/>website&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="main_8c_1a0927899c9935565cac8bab05b2fe2342" kindref="member">processSite</ref>(stdbuff,<sp/>logfile,<sp/><ref refid="main_8c_1a50267d552ca6f788254032e40046b770" kindref="member">DEPTH</ref>,websiteDir)==1)</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Unable<sp/>to<sp/>properly<sp/>process<sp/>website\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Website<sp/>got<sp/>downloaded<sp/>and<sp/>is<sp/>avalaible<sp/>for<sp/>offline<sp/>use.\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!strncmp<sp/>(stdbuff,</highlight><highlight class="stringliteral">&quot;GOOGLE:<sp/>&quot;</highlight><highlight class="normal">,8))</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Started<sp/>processing<sp/>your<sp/>google<sp/>query,<sp/>please<sp/>wait...\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;User<sp/>input:&quot;</highlight><highlight class="normal">,stdbuff);</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;System<sp/>response:&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;GOOGLE<sp/>QUERY&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="main_8c_1a08fdc4145d944803c9113e813daabfd7" kindref="member">processQuery</ref>(stdbuff,<sp/>logfile)==1)</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Unable<sp/>to<sp/>properly<sp/>process<sp/>website\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Query<sp/>got<sp/>processed<sp/>and<sp/>is<sp/>avalaible<sp/>for<sp/>offline<sp/>use.\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!strcmp(stdbuff,<sp/></highlight><highlight class="stringliteral">&quot;help.&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;User<sp/>input:&quot;</highlight><highlight class="normal">,stdbuff);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;System<sp/>response:&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;Help<sp/>request&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;To<sp/>download<sp/>website<sp/>one<sp/>needs<sp/>to<sp/>write<sp/>it&apos;s<sp/>name<sp/>in<sp/>format:\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;http://www.&lt;&lt;nameofwebsite&gt;&gt;.&lt;&lt;domain&gt;&gt;/&lt;&lt;perhaps_more_address&gt;&gt;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;And<sp/>press<sp/>ENTER\n(Be<sp/>careful!<sp/>Wrong<sp/>format<sp/>may<sp/>cause<sp/>application<sp/>to<sp/>not<sp/>work<sp/>properly!\n\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;To<sp/>download<sp/>google<sp/>query<sp/>one<sp/>needs<sp/>to<sp/>write<sp/>it<sp/>in<sp/>format:\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;GOOGLE:<sp/>&lt;&lt;ALL_YOUR_QUERY_HERE&gt;&gt;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;And<sp/>press<sp/>ENTER\n(Be<sp/>careful!<sp/>Wrong<sp/>format<sp/>may<sp/>cause<sp/>application<sp/>to<sp/>not<sp/>work<sp/>properly!\n\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;To<sp/>leave,<sp/>write<sp/>\&quot;q.\&quot;<sp/>and<sp/>press<sp/>ENTER\n\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;User<sp/>input:&quot;</highlight><highlight class="normal">,stdbuff);</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;System<sp/>response:&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;Meaningless<sp/>input&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;meaningless<sp/>input\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a1a8bb385160d2854b0c2ebb85db2d212" kindref="member">EXIT_SUCCESS</ref>;</highlight></codeline>
<codeline lineno="217"><highlight class="normal">}</highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight></codeline>
<codeline lineno="220"></codeline>
<codeline lineno="224"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="main_8c_1ad2e9329c79af041e6af1066c4aea42d7" kindref="member">die</ref><sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*s<sp/>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1acb559820d9ca11295b4500f179ef6392" kindref="member">i</ref>)</highlight></codeline>
<codeline lineno="225"><highlight class="normal">{</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/>perror(s);</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>exit(i);</highlight></codeline>
<codeline lineno="228"><highlight class="normal">}</highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="231"></codeline>
<codeline lineno="235"><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*timebuff<sp/>)</highlight></codeline>
<codeline lineno="236"><highlight class="normal">{</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">tm<sp/>*sTm;</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/>time_t<sp/>now<sp/>=<sp/>time<sp/>(0);</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/>sTm<sp/>=<sp/>gmtime<sp/>(&amp;now);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/>strftime<sp/>(timebuff,<sp/><ref refid="main_8c_1a0cde4104edca15f3c3c51238bc0edbd1" kindref="member">TIMESIZE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%Y-%m-%d<sp/>%H:%M:%S&quot;</highlight><highlight class="normal">,<sp/>sTm);</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>timebuff;</highlight></codeline>
<codeline lineno="242"><highlight class="normal">}</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="249"></codeline>
<codeline lineno="254"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a3ec9442703dfaaa0430bb5cbdadfcbf4" kindref="member">preprocess_website</ref><sp/>(<ref refid="structwebaddr" kindref="compound">WebAddr</ref><sp/>*website,<sp/>FILE<sp/>*log)</highlight></codeline>
<codeline lineno="255"><highlight class="normal">{</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>timebuff[<ref refid="main_8c_1a0cde4104edca15f3c3c51238bc0edbd1" kindref="member">TIMESIZE</ref>];</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!(website-&gt;<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref><sp/>!=<sp/>NULL<sp/>&amp;&amp;<sp/>website-&gt;<ref refid="structwebaddr_1adbcf7f77feac63817fea7393f4dfbfb7" kindref="member">url</ref><sp/>!=<sp/>NULL<sp/>))</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;invalid<sp/>argument<sp/>for<sp/>partitionAddress()&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>EXIT_FAILURE;</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(website-&gt;<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>))<sp/>)</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;buffer<sp/>overflow<sp/>inside<sp/>partitionAddress()&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>EXIT_FAILURE;</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="270"><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1acb559820d9ca11295b4500f179ef6392" kindref="member">i</ref><sp/>=<sp/>strcspn<sp/>(website-&gt;<ref refid="structwebaddr_1adbcf7f77feac63817fea7393f4dfbfb7" kindref="member">url</ref>+7,</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((i+7)&gt;48)</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Hostname<sp/>too<sp/>long&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>EXIT_FAILURE;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((i+7)&gt;204)</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;page<sp/>too<sp/>long&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>EXIT_FAILURE;</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;copying<sp/>hostname<sp/>and<sp/>webpage....<sp/>successful&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="main_8c_1a70558265885283cfdbfb00c08d22c5b5" kindref="member">pch</ref><sp/>=<sp/>strrchr<sp/>(website-&gt;<ref refid="structwebaddr_1adbcf7f77feac63817fea7393f4dfbfb7" kindref="member">url</ref>,</highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(website-&gt;<ref refid="structwebaddr_1a172af9053ce39ac0fb516a49dad60137" kindref="member">filename</ref>,<sp/>pch+1);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/>strncpy(website-&gt;<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>,website-&gt;<ref refid="structwebaddr_1adbcf7f77feac63817fea7393f4dfbfb7" kindref="member">url</ref>,i+7);<sp/></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>l<sp/>=<sp/>pch-(website-&gt;<ref refid="structwebaddr_1adbcf7f77feac63817fea7393f4dfbfb7" kindref="member">url</ref>+i+7);</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/>strncpy(website-&gt;<ref refid="structwebaddr_1a6bd3f94771bd80028ae544431f795d27" kindref="member">page</ref>,website-&gt;<ref refid="structwebaddr_1adbcf7f77feac63817fea7393f4dfbfb7" kindref="member">url</ref>+i+7,l+1);</highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;\nname:<sp/>%s,<sp/>hostname:%s,<sp/>page:%s\n&quot;</highlight><highlight class="normal">,<sp/>website-&gt;<ref refid="structwebaddr_1adbcf7f77feac63817fea7393f4dfbfb7" kindref="member">url</ref>,<sp/>website-&gt;<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>,<sp/>website-&gt;<ref refid="structwebaddr_1a6bd3f94771bd80028ae544431f795d27" kindref="member">page</ref>);</highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;obtain<sp/>IP<sp/>address<sp/>for<sp/>website&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">addrinfo<sp/>hints,<sp/>*servinfo,<sp/>*p;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">sockaddr_in<sp/>*h;</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a5e983cb99d0067297dc556d97f99ade0" kindref="member">memset</ref>(&amp;hints,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>hints);</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/>hints.ai_family<sp/>=<sp/>AF_INET;</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/>hints.ai_socktype<sp/>=<sp/>SOCK_STREAM;</highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//excluding<sp/>http://<sp/>for<sp/>getaddrinfo<sp/>to<sp/>work</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(rv<sp/>=<sp/>getaddrinfo(<sp/>website-&gt;<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>+7<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;http&quot;</highlight><highlight class="normal"><sp/>,<sp/>&amp;hints<sp/>,<sp/>&amp;servinfo))<sp/>!=<sp/>0)</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>getaddrinfo<sp/>error:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/>gai_strerror(rv));</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(stderr,<sp/></highlight><highlight class="stringliteral">&quot;getaddrinfo:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/>gai_strerror(rv));</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="313"><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(p<sp/>=<sp/>servinfo;<sp/>p<sp/>!=<sp/>NULL;<sp/>p<sp/>=<sp/>p-&gt;ai_next)</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>h<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">sockaddr_in<sp/>*)<sp/>p-&gt;ai_addr;</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(website-&gt;<ref refid="structwebaddr_1a22dd553f58fc86f422e856af77d5d7a7" kindref="member">IP</ref><sp/>,<sp/>inet_ntoa(<sp/>h-&gt;sin_addr<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/>freeaddrinfo(servinfo);<sp/></highlight><highlight class="comment">//<sp/>all<sp/>done<sp/>with<sp/>this<sp/>structure</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;success<sp/>DNS<sp/>query&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a1a8bb385160d2854b0c2ebb85db2d212" kindref="member">EXIT_SUCCESS</ref>;</highlight></codeline>
<codeline lineno="324"><highlight class="normal">}</highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="331"></codeline>
<codeline lineno="335"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a08fdc4145d944803c9113e813daabfd7" kindref="member">processQuery</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*query<sp/>,<sp/>FILE<sp/>*log<sp/>)</highlight></codeline>
<codeline lineno="336"><highlight class="normal">{</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/>FILE<sp/>*logfile;</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>timebuff[<ref refid="main_8c_1a0cde4104edca15f3c3c51238bc0edbd1" kindref="member">TIMESIZE</ref>];</highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(log<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*logname;</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*logdir;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logname<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc<sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)*36);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logdir<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc<sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(logname)*strlen(logname)+</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(char)*7);</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref><sp/>(logname,<sp/></highlight><highlight class="stringliteral">&quot;GOOGLEQUERY<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(logname,<ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff));</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(logname,</highlight><highlight class="stringliteral">&quot;.txt&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(logdir,<sp/></highlight><highlight class="stringliteral">&quot;./logs/&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(logdir,logname);</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">stat<sp/>st<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat(logdir,<sp/>&amp;st)<sp/>==<sp/>-1)</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mkdir(logdir,<sp/>0700);</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logfile=fopen(logdir,</highlight><highlight class="stringliteral">&quot;w&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(logfile==NULL)</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Unable<sp/>to<sp/>create<sp/>%s<sp/>file.&quot;</highlight><highlight class="normal">,<sp/>logname);</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ad2e9329c79af041e6af1066c4aea42d7" kindref="member">die</ref>(</highlight><highlight class="stringliteral">&quot;error<sp/>creating<sp/>log<sp/>file&quot;</highlight><highlight class="normal">,<sp/>5);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logfile<sp/>=<sp/>log;</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>\&quot;%s\&quot;\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Started<sp/>processing<sp/>query&quot;</highlight><highlight class="normal">,<sp/>query);</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="main_8c_1a70558265885283cfdbfb00c08d22c5b5" kindref="member">pch</ref>;</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="main_8c_1a06a82fbaf784823f4d43dde28f35afc1" kindref="member">tmp</ref>;</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/>query+=8;</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref><sp/>(logfile,</highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>\&quot;%s\&quot;<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Splitting<sp/>string&quot;</highlight><highlight class="normal">,<sp/>query,<sp/></highlight><highlight class="stringliteral">&quot;into<sp/>tokens.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/>tmp<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc<sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)*(strlen(query)+30));</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref><sp/>(tmp,<sp/></highlight><highlight class="stringliteral">&quot;http://www.google.de/search?q=&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/>pch<sp/>=<sp/>strtok<sp/>(query,<sp/></highlight><highlight class="stringliteral">&quot;<sp/>,.-\&quot;&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(1)</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(tmp,pch);</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref><sp/>(logfile,</highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>\&quot;%s\&quot;<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Got<sp/>token&quot;</highlight><highlight class="normal">,<sp/>pch,<sp/></highlight><highlight class="stringliteral">&quot;from<sp/>string.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pch<sp/>=<sp/>strtok<sp/>(NULL,<sp/></highlight><highlight class="stringliteral">&quot;<sp/>,.-\&quot;&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pch<sp/>!=<sp/>NULL)</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(tmp,</highlight><highlight class="stringliteral">&quot;+&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="389"><highlight class="normal"></highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref><sp/>(logfile,</highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>\&quot;%s\&quot;\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Finished<sp/>processing<sp/>query<sp/>into<sp/>string:&quot;</highlight><highlight class="normal">,<sp/>tmp);</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0927899c9935565cac8bab05b2fe2342" kindref="member">processSite</ref>(tmp,<sp/>logfile,<sp/><ref refid="main_8c_1a50267d552ca6f788254032e40046b770" kindref="member">DEPTH</ref>,</highlight><highlight class="stringliteral">&quot;./&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/>query-=8;</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>\&quot;%s\&quot;\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Finished<sp/>processing<sp/>query&quot;</highlight><highlight class="normal">,<sp/>query);</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a1a8bb385160d2854b0c2ebb85db2d212" kindref="member">EXIT_SUCCESS</ref>;</highlight></codeline>
<codeline lineno="396"><highlight class="normal">}</highlight></codeline>
<codeline lineno="397"><highlight class="normal"></highlight></codeline>
<codeline lineno="398"><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"></codeline>
<codeline lineno="410"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a3310125badd0ce971c1098c13655edcb" kindref="member">requestWebsite</ref><sp/>(<ref refid="structwebaddr" kindref="compound">WebAddr</ref><sp/>*website<sp/>,<sp/>FILE<sp/>*log<sp/>,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*buffer<sp/>,</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*<ref refid="main_8c_1a7c20c420237aa9283515ea5c242479e7" kindref="member">buflen</ref><sp/><sp/>);</highlight></codeline>
<codeline lineno="411"><highlight class="normal">{</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>timebuff[<ref refid="main_8c_1a0cde4104edca15f3c3c51238bc0edbd1" kindref="member">TIMESIZE</ref>];</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">sockaddr_in<sp/>si_server;</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/>socklen_t<sp/><ref refid="main_8c_1a63365583bb04acd30e30fc3239879356" kindref="member">sock_length</ref><sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="main_8c_1a8b87b233658bd1635573fa82a38441e9" kindref="member">si_server</ref>);</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a5faf35ef04c3a66a39ae4301d53a8851" kindref="member">data</ref>[<ref refid="main_8c_1ad974fe981249f5e84fbf1683b012c9f8" kindref="member">BUFLEN</ref>];</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a7ee9c2c6090084f2f66e2e6fa03ee581" kindref="member">sock_id</ref>;</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a951f9b990c2279828c39a5da644c630e" kindref="member">rcv_length</ref>=-1;</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/>*<ref refid="main_8c_1a7c20c420237aa9283515ea5c242479e7" kindref="member">buflen</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Initialisation<sp/>of<sp/>requestWebsite()<sp/>inside<sp/>of<sp/>processSite()&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="main_8c_1a51e6a0d2bcb8531a5e5adcd66a77aa3b" kindref="member">request</ref>;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/>request<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc<sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(website-&gt;<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>)*strlen(website-&gt;<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>)+</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(website-&gt;<ref refid="structwebaddr_1a6bd3f94771bd80028ae544431f795d27" kindref="member">page</ref>)*strlen(website-&gt;<ref refid="structwebaddr_1a6bd3f94771bd80028ae544431f795d27" kindref="member">page</ref>)+</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(char)*75);</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(request,<sp/></highlight><highlight class="stringliteral">&quot;GET<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(request,<sp/>website-&gt;<ref refid="structwebaddr_1a6bd3f94771bd80028ae544431f795d27" kindref="member">page</ref>);</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(request,<sp/>website-&gt;<ref refid="structwebaddr_1a172af9053ce39ac0fb516a49dad60137" kindref="member">filename</ref>);</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(request,<sp/></highlight><highlight class="stringliteral">&quot;<sp/>HTTP/1.1\r\nHost:<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(request,<sp/>website-&gt;<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>+7);</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(request,<sp/></highlight><highlight class="stringliteral">&quot;\r\nUser-Agent:<sp/>Mozilla/5.0<sp/>(X11;<sp/>Ubuntu;<sp/>Linux<sp/>i686;<sp/>rv:44.0)<sp/>Gecko/20100101<sp/>Firefox/44.0\r\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(request,<sp/></highlight><highlight class="stringliteral">&quot;\r\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s\n%s\n%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;SENT<sp/>REQUEST:&quot;</highlight><highlight class="normal">,<sp/>request);</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Set<sp/>the<sp/>criteria</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a5e983cb99d0067297dc556d97f99ade0" kindref="member">memset</ref>((</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)&amp;si_server,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(si_server));<sp/></highlight><highlight class="comment">//<sp/>Set<sp/>the<sp/>structure<sp/>to<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/>si_server.sin_family<sp/>=<sp/>AF_INET;</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/>si_server.sin_port<sp/>=<sp/>htons(<ref refid="main_8c_1a614217d263be1fb1a5f76e2ff7be19a2" kindref="member">PORT</ref>);</highlight></codeline>
<codeline lineno="435"><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/>sock_id<sp/>=<sp/>socket(AF_INET,<sp/>SOCK_STREAM,<sp/>0);</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sock_id<sp/>==<sp/>-1)</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Socket()<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>FAILURE&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Socket()<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>SUCCESS&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="441"><highlight class="normal"></highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(inet_aton(website-&gt;<ref refid="structwebaddr_1a22dd553f58fc86f422e856af77d5d7a7" kindref="member">IP</ref>,<sp/>&amp;si_server.sin_addr)<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;inet_aton()<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>FAILURE&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;inet_aton()<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>SUCCESS&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="446"><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Initialisation<sp/>of<sp/>connect()<sp/>inside<sp/>requestWebsite()&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="448"><highlight class="normal"></highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connect(<sp/>sock_id,<sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/>sockaddr<sp/>*)<sp/>&amp;si_server,<sp/>sock_length)<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;connect()<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>SUCCESS&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;connect()<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>FAILURE&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>EXIT_FAILURE;</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(send(sock_id,<sp/>request,<sp/>strlen(request),<sp/>0)<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;send()<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>FAILURE&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>EXIT_FAILURE;</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;send()<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>SUCCESS&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="465"><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(1)</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rcv_length<sp/>=<sp/>recv(sock_id,<sp/>data,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(data),<sp/>0);</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rcv_length<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;recv()<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>SUCCESS&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*<ref refid="main_8c_1a7c20c420237aa9283515ea5c242479e7" kindref="member">buflen</ref><sp/>&lt;=<sp/><ref refid="main_8c_1ad974fe981249f5e84fbf1683b012c9f8" kindref="member">BUFLEN</ref>-1)</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;var<sp/>rcv_length<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>OK&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(buffer+(*<ref refid="main_8c_1a7c20c420237aa9283515ea5c242479e7" kindref="member">buflen</ref>),<sp/>data,rcv_length);</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="main_8c_1a7c20c420237aa9283515ea5c242479e7" kindref="member">buflen</ref><sp/>+=<sp/><ref refid="main_8c_1a951f9b990c2279828c39a5da644c630e" kindref="member">rcv_length</ref>;</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;var<sp/>rcv_length<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>DATA<sp/>TOO<sp/>LONG&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;var<sp/>rcv_length<sp/>inside<sp/>requestWebsite()<sp/>::&quot;</highlight><highlight class="normal">,<sp/>rcv_length);</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a2f6ecf16430ef9fee42b41d25af1bfc7" kindref="member">close</ref>(sock_id);</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>EXIT_FAILURE;</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(rcv_length==0)</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;recv()<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>SUCCESS,<sp/>databytes<sp/>read:&quot;</highlight><highlight class="normal">,*<ref refid="main_8c_1a7c20c420237aa9283515ea5c242479e7" kindref="member">buflen</ref>);</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(rcv_length<sp/>==<sp/>-1)</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;recv()<sp/>inside<sp/>requestWebsite()<sp/>::<sp/>FAILURE&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a2f6ecf16430ef9fee42b41d25af1bfc7" kindref="member">close</ref>(sock_id);</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>EXIT_FAILURE;</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/><ref refid="main_8c_1ae447355422889376eec4096495140356" kindref="member">beginning_of_data</ref><sp/>=strstr(buffer,</highlight><highlight class="stringliteral">&quot;\r\n\r\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1aed7ea92f45bd273dde380a45ddced592" kindref="member">offset</ref><sp/>=<sp/>beginning_of_data-buffer+4;<sp/></highlight><highlight class="comment">//+4<sp/>fehlt</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(beginning_of_data<sp/>!=NULL)</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*buflen)<sp/>=<sp/>(*buflen)-<sp/><ref refid="main_8c_1aed7ea92f45bd273dde380a45ddced592" kindref="member">offset</ref>;</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memmove(buffer,buffer<sp/>+offset,*<ref refid="main_8c_1a7c20c420237aa9283515ea5c242479e7" kindref="member">buflen</ref>);</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//buffer<sp/>=<sp/>beginning_of_data+4;<sp/>//the<sp/>escape<sp/>character<sp/>sequence<sp/>has<sp/>to<sp/>be<sp/>excluded</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="506"><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a2f6ecf16430ef9fee42b41d25af1bfc7" kindref="member">close</ref>(sock_id);</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a1a8bb385160d2854b0c2ebb85db2d212" kindref="member">EXIT_SUCCESS</ref>;</highlight></codeline>
<codeline lineno="510"><highlight class="normal">}</highlight></codeline>
<codeline lineno="512"></codeline>
<codeline lineno="519"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1ae2a4d2cd293581a9bf485ce2a5b80abb" kindref="member">editAndSave</ref><sp/>(<ref refid="structwebaddr" kindref="compound">WebAddr</ref><sp/>*website<sp/>,<sp/>FILE<sp/>*log<sp/>,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*content<sp/>,<sp/><ref refid="structsimple__list" kindref="compound">list</ref><sp/>*new_requests<sp/>);</highlight></codeline>
<codeline lineno="520"><highlight class="normal">{</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>timebuff[<ref refid="main_8c_1a0cde4104edca15f3c3c51238bc0edbd1" kindref="member">TIMESIZE</ref>];</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Initialisation<sp/>of<sp/>editAndSave()<sp/>inside<sp/>of<sp/>processSite()&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/>new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc(<ref refid="main_8c_1a4cb4212918ebefaca678d654dce4425e" kindref="member">URLSIZE</ref>);</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structsimple__list" kindref="compound">list</ref><sp/>*<sp/><ref refid="main_8c_1a34bcf9f163ce26968812dff83ee92226" kindref="member">initial_pointer</ref><sp/>=<sp/><ref refid="main_8c_1a08fed31ac160af672213774bd2392159" kindref="member">new_requests</ref>;</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/><ref refid="main_8c_1a70558265885283cfdbfb00c08d22c5b5" kindref="member">pch</ref><sp/>=content,*<ref refid="main_8c_1a0b3c00e3771bedff51dc5e6999709bcf" kindref="member">positionbuf</ref>;</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="main_8c_1a06a82fbaf784823f4d43dde28f35afc1" kindref="member">tmp</ref>;</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1acb559820d9ca11295b4500f179ef6392" kindref="member">i</ref>;</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;i&lt;<ref refid="main_8c_1a60d6a5ff7d7c74135c525acb9e8ee7a1" kindref="member">MAX_REQ</ref>;)</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>positionbuf<sp/>=<sp/>strstr(pch,</highlight><highlight class="stringliteral">&quot;src=\&quot;&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(positionbuf==NULL)</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//no<sp/>further<sp/>occurrence<sp/>found</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pch<sp/>=<sp/>strstr(positionbuf+5,</highlight><highlight class="stringliteral">&quot;\&quot;&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc<sp/>(pch-(positionbuf+5)+1);</highlight><highlight class="comment">//length<sp/>of<sp/>src=&quot;<sp/>is<sp/>5,<sp/>-1<sp/>to<sp/>exclude<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a5e983cb99d0067297dc556d97f99ade0" kindref="member">memset</ref>(tmp,0,pch-(positionbuf+5)+1);</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(tmp,positionbuf+5,<sp/>pch-(positionbuf+5));</highlight></codeline>
<codeline lineno="539"><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(strstr(tmp,</highlight><highlight class="stringliteral">&quot;http://&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref>,<sp/>tmp);</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref>,<sp/>website-&gt;<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>);</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref>,<sp/>website-&gt;<ref refid="structwebaddr_1a6bd3f94771bd80028ae544431f795d27" kindref="member">page</ref>);<sp/></highlight><highlight class="comment">//<sp/>ist<sp/>ein<sp/>/<sp/>nach<sp/>der<sp/>page<sp/>address<sp/>vorhanden?<sp/>müsste!!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref>,<sp/>tmp);</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_requests-&gt;<ref refid="structsimple__list_1a136337c2e78395502680cfc27cb1dc0e" kindref="member">next</ref><sp/>=(<ref refid="structsimple__list" kindref="compound">list</ref><sp/>*)<sp/>malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/><ref refid="structsimple__list" kindref="compound">list</ref>));</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_requests<sp/>=<sp/>new_requests-&gt;<ref refid="structsimple__list_1a136337c2e78395502680cfc27cb1dc0e" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc(<ref refid="main_8c_1a4cb4212918ebefaca678d654dce4425e" kindref="member">URLSIZE</ref>);</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/>pch=content;</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(;i&lt;<ref refid="main_8c_1a60d6a5ff7d7c74135c525acb9e8ee7a1" kindref="member">MAX_REQ</ref>;)</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>positionbuf<sp/>=<sp/>strstr(pch,</highlight><highlight class="stringliteral">&quot;href=\&quot;&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(positionbuf==NULL)</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//no<sp/>further<sp/>occurrence<sp/>found</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pch<sp/>=<sp/>strstr(positionbuf+6,</highlight><highlight class="stringliteral">&quot;\&quot;&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc<sp/>(pch-(positionbuf+6)+1);</highlight><highlight class="comment">//length<sp/>of<sp/>src=&quot;<sp/>is<sp/>5,<sp/>-1<sp/>to<sp/>exclude<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a5e983cb99d0067297dc556d97f99ade0" kindref="member">memset</ref>(tmp,0,pch-(positionbuf+5)+1);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(tmp,positionbuf+6,<sp/>pch-(positionbuf+6));</highlight></codeline>
<codeline lineno="565"><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(strstr(tmp,</highlight><highlight class="stringliteral">&quot;http://&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref>,<sp/>tmp);</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref>,<sp/>website-&gt;<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>);</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref>,<sp/>website-&gt;<ref refid="structwebaddr_1a6bd3f94771bd80028ae544431f795d27" kindref="member">page</ref>);<sp/></highlight><highlight class="comment">//<sp/>ist<sp/>ein<sp/>/<sp/>nach<sp/>der<sp/>page<sp/>address<sp/>vorhanden?<sp/>müsste!!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref>,<sp/>tmp);</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_requests-&gt;<ref refid="structsimple__list_1a136337c2e78395502680cfc27cb1dc0e" kindref="member">next</ref><sp/>=(<ref refid="structsimple__list" kindref="compound">list</ref><sp/>*)<sp/>malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/><ref refid="structsimple__list" kindref="compound">list</ref>));</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_requests<sp/>=<sp/>new_requests-&gt;<ref refid="structsimple__list_1a136337c2e78395502680cfc27cb1dc0e" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc(<ref refid="main_8c_1a4cb4212918ebefaca678d654dce4425e" kindref="member">URLSIZE</ref>);</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/>new_requests<sp/>=<sp/><ref refid="main_8c_1a34bcf9f163ce26968812dff83ee92226" kindref="member">initial_pointer</ref>;</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(logfile<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;All<sp/>links<sp/>of<sp/>the<sp/>website<sp/>have<sp/>been<sp/>saved&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a1a8bb385160d2854b0c2ebb85db2d212" kindref="member">EXIT_SUCCESS</ref>;</highlight></codeline>
<codeline lineno="583"><highlight class="normal">}</highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"></highlight></codeline>
<codeline lineno="587"><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"></highlight></codeline>
<codeline lineno="590"></codeline>
<codeline lineno="596"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a0927899c9935565cac8bab05b2fe2342" kindref="member">processSite</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*name,<sp/>FILE<sp/>*log,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>depth,</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/>current_folder)</highlight></codeline>
<codeline lineno="597"><highlight class="normal">{</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>timebuff[<ref refid="main_8c_1a0cde4104edca15f3c3c51238bc0edbd1" kindref="member">TIMESIZE</ref>];</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(depth<sp/>&lt;<sp/>1)</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Maximum<sp/>depth<sp/>reached,<sp/>website<sp/>not<sp/>processed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>EXIT_FAILURE;</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\t%s,<sp/>%s<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Started<sp/>processing<sp/>website&quot;</highlight><highlight class="normal">,<sp/>name,<sp/></highlight><highlight class="stringliteral">&quot;DEPTH<sp/>::&quot;</highlight><highlight class="normal">,<sp/>depth);</highlight></codeline>
<codeline lineno="605"><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structwebaddr" kindref="compound">WebAddr</ref><sp/>website;</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a5e983cb99d0067297dc556d97f99ade0" kindref="member">memset</ref>(website.<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>,0,<ref refid="main_8c_1a47893e86457950c30831b9cb0e7c3235" kindref="member">HOSTSIZE</ref>-1);</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a5e983cb99d0067297dc556d97f99ade0" kindref="member">memset</ref>(website.<ref refid="structwebaddr_1a22dd553f58fc86f422e856af77d5d7a7" kindref="member">IP</ref>,0,49);</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a5e983cb99d0067297dc556d97f99ade0" kindref="member">memset</ref>(website.<ref refid="structwebaddr_1a6bd3f94771bd80028ae544431f795d27" kindref="member">page</ref>,0,<ref refid="main_8c_1a4cb4212918ebefaca678d654dce4425e" kindref="member">URLSIZE</ref>-<ref refid="main_8c_1a47893e86457950c30831b9cb0e7c3235" kindref="member">HOSTSIZE</ref>-1);</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a5e983cb99d0067297dc556d97f99ade0" kindref="member">memset</ref>(website.<ref refid="structwebaddr_1a172af9053ce39ac0fb516a49dad60137" kindref="member">filename</ref>,0,<ref refid="main_8c_1a4cb4212918ebefaca678d654dce4425e" kindref="member">URLSIZE</ref>-<ref refid="main_8c_1a47893e86457950c30831b9cb0e7c3235" kindref="member">HOSTSIZE</ref>-1);</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a5e983cb99d0067297dc556d97f99ade0" kindref="member">memset</ref>(website.<ref refid="structwebaddr_1adbcf7f77feac63817fea7393f4dfbfb7" kindref="member">url</ref>,0,<ref refid="main_8c_1a4cb4212918ebefaca678d654dce4425e" kindref="member">URLSIZE</ref>-1);</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(website.<ref refid="structwebaddr_1adbcf7f77feac63817fea7393f4dfbfb7" kindref="member">url</ref>,<sp/>name);</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a3ec9442703dfaaa0430bb5cbdadfcbf4" kindref="member">preprocess_website</ref>(&amp;website,<sp/>log);</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/>website.<ref refid="structwebaddr_1adbcf7f77feac63817fea7393f4dfbfb7" kindref="member">url</ref>,<sp/></highlight><highlight class="stringliteral">&quot;hostname<sp/>is&quot;</highlight><highlight class="normal">,<sp/>website.<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>);</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/>website.<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>,<sp/></highlight><highlight class="stringliteral">&quot;resolved<sp/>to&quot;</highlight><highlight class="normal">,<sp/>website.<ref refid="structwebaddr_1a22dd553f58fc86f422e856af77d5d7a7" kindref="member">IP</ref>);</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Demanded<sp/>page<sp/>is&quot;</highlight><highlight class="normal">,<sp/>website.<ref refid="structwebaddr_1a6bd3f94771bd80028ae544431f795d27" kindref="member">page</ref>);</highlight></codeline>
<codeline lineno="618"><highlight class="normal"></highlight></codeline>
<codeline lineno="619"><highlight class="normal"></highlight></codeline>
<codeline lineno="621"><highlight class="normal"></highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>content[<ref refid="main_8c_1ad974fe981249f5e84fbf1683b012c9f8" kindref="member">BUFLEN</ref>];</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>received_data_size;</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a5e983cb99d0067297dc556d97f99ade0" kindref="member">memset</ref>(content,<sp/>0,<sp/><ref refid="main_8c_1ad974fe981249f5e84fbf1683b012c9f8" kindref="member">BUFLEN</ref>-1);</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="main_8c_1a3310125badd0ce971c1098c13655edcb" kindref="member">requestWebsite</ref><sp/>(&amp;website,<sp/>log,<sp/>content,&amp;received_data_size)==0)</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;requestWebsite()<sp/>inside<sp/>processSite()<sp/>::<sp/>SUCCESS&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;requestWebsite()<sp/>inside<sp/>processSite()<sp/>::<sp/>FAILURE&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>EXIT_FAILURE;</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="632"><highlight class="normal"></highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structsimple__list" kindref="compound">list</ref><sp/>*new_requests<sp/>=malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structsimple__list" kindref="compound">list</ref>));</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="main_8c_1ae2a4d2cd293581a9bf485ce2a5b80abb" kindref="member">editAndSave</ref><sp/>(&amp;website,<sp/>log,<sp/>content,<sp/>new_requests)==0)</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;editAndSave()<sp/>inside<sp/>processSite()<sp/>::<sp/>SUCCESS&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;editAndSave()<sp/>inside<sp/>processSite()<sp/>::<sp/>FAILURE&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>EXIT_FAILURE;</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="642"><highlight class="normal"></highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>websvr_header_length<sp/>=0;</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*websiteDir<sp/>=<sp/>current_folder;</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strstr(website.<ref refid="structwebaddr_1a172af9053ce39ac0fb516a49dad60137" kindref="member">filename</ref>,</highlight><highlight class="stringliteral">&quot;.htm&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>websvr_header_length<sp/>=<sp/>strstr(content,</highlight><highlight class="stringliteral">&quot;&lt;!doctype<sp/>HTML&quot;</highlight><highlight class="normal">)-content;</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(websiteDir,<sp/>website.<ref refid="structwebaddr_1a172af9053ce39ac0fb516a49dad60137" kindref="member">filename</ref>);</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(websiteDir,</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">stat<sp/>st<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat(websiteDir,<sp/>&amp;st)<sp/>==<sp/>-1)</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mkdir(websiteDir,<sp/>0700);</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/>FILE<sp/>*file;</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/>filename<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)<sp/>malloc(strlen(website.<ref refid="structwebaddr_1a172af9053ce39ac0fb516a49dad60137" kindref="member">filename</ref>)+strlen(websiteDir)+50);</highlight></codeline>
<codeline lineno="660"><highlight class="normal"></highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a0a86dd220f83f5a1a2bff5e4615e35e8" kindref="member">strcpy</ref>(filename,websiteDir);</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(strlen(website.<ref refid="structwebaddr_1a172af9053ce39ac0fb516a49dad60137" kindref="member">filename</ref>)==0)</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(filename,<sp/>(website.<ref refid="structwebaddr_1abc809c253db3b5cb111bc1730715596b" kindref="member">hostname</ref>+7)<sp/>);</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ac439ba058ce3f79e8310f88c9a3fe1fb" kindref="member">strcat</ref>(filename,<sp/>website.<ref refid="structwebaddr_1a172af9053ce39ac0fb516a49dad60137" kindref="member">filename</ref><sp/>);</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/>file=fopen(filename,</highlight><highlight class="stringliteral">&quot;wb&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(file==NULL)</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Unable<sp/>to<sp/>create<sp/>%s<sp/>file.&quot;</highlight><highlight class="normal">,<sp/>filename);</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1ad2e9329c79af041e6af1066c4aea42d7" kindref="member">die</ref>(</highlight><highlight class="stringliteral">&quot;error<sp/>creating<sp/><sp/>file&quot;</highlight><highlight class="normal">,<sp/>5);</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/>free(filename);</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/>fwrite<sp/>(content+websvr_header_length<sp/>,<sp/>received_data_size-websvr_header_length,<sp/>1,<sp/>file);</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/>fclose<sp/>(file);</highlight></codeline>
<codeline lineno="679"><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"></highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;<sp/>new_requests-&gt;<ref refid="structsimple__list_1a136337c2e78395502680cfc27cb1dc0e" kindref="member">next</ref>!=NULL<sp/>;<sp/>new_requests<sp/>=<sp/>new_requests-&gt;<ref refid="structsimple__list_1a136337c2e78395502680cfc27cb1dc0e" kindref="member">next</ref>)</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref><sp/>(log,</highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>\&quot;%s\&quot;<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Got<sp/>URI&quot;</highlight><highlight class="normal">,<sp/>new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref>,<sp/></highlight><highlight class="stringliteral">&quot;from<sp/>char<sp/>array<sp/>_new_requests&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="main_8c_1a0927899c9935565cac8bab05b2fe2342" kindref="member">processSite</ref>(new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref>,<sp/>log,<sp/>depth-1,websiteDir))</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref><sp/>(log,</highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>\&quot;%s\&quot;\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Couldn&apos;t<sp/>proccess<sp/>resource&quot;</highlight><highlight class="normal">,<sp/>new_requests-&gt;<ref refid="structsimple__list_1aed1cfb225a5fb77461e7972691e68a72" kindref="member">string</ref>);</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref><sp/>(log,</highlight><highlight class="stringliteral">&quot;%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;No<sp/>more<sp/>URIs<sp/>left.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="main_8c_1a9c637955d59085590770de85709bd193" kindref="member">fprintf</ref>(log<sp/>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="main_8c_1a60fab1f99c8e95160f038def2f54015d" kindref="member">getTimeBuffer</ref>(timebuff),<sp/></highlight><highlight class="stringliteral">&quot;Finished<sp/>processing<sp/>website&quot;</highlight><highlight class="normal">,<sp/>website.<ref refid="structwebaddr_1adbcf7f77feac63817fea7393f4dfbfb7" kindref="member">url</ref>);</highlight></codeline>
<codeline lineno="690"><highlight class="normal"></highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="main_8c_1a1a8bb385160d2854b0c2ebb85db2d212" kindref="member">EXIT_SUCCESS</ref>;</highlight></codeline>
<codeline lineno="692"><highlight class="normal"></highlight></codeline>
<codeline lineno="693"><highlight class="normal">}</highlight></codeline>
<codeline lineno="694"><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"></highlight></codeline>
<codeline lineno="696"><highlight class="normal"></highlight></codeline>
<codeline lineno="697"><highlight class="normal"></highlight></codeline>
<codeline lineno="698"><highlight class="normal"></highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="main.c"/>
  </compounddef>
</doxygen>
